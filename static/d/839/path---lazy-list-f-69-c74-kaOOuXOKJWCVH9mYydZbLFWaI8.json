{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog","author":"Kyle Mathews"}},"markdownRemark":{"id":"a4973d9f-eea3-5edb-a832-cc1ca8746cec","html":"<p>I have been following <a href=\"http://blog.wekeroad.com/\" target=\"_blank\">Rob Conery’s</a> posts on the MVC Storefront, and trying the repository/pipes-filters for data access that he has been using.</p>\n<p>While trying out the implementation of a LazyList he was using, I had noticed that the example table was being joined onto the category table. At the time however, I really had not thought much of it, until I read <a href=\"http://blog.wekeroad.com/mvc-storefront/mvcstore-intermission2/\" target=\"_blank\">MVC Storefront: Brainbender Intermission</a> which got me thinking. </p>\n<p>Admittedly, I don’t really have to much of a problem with it loading all of the examples for all the categories at one time at the moment. However, I figured it would be nice to have it work the way intended, and query the database for the examples in a category only when asked for.</p>\n<p>I liked the idea of the LazyList, and since I was already using a Service class for all data access, along with setting up the category hierarchy I moved the creation of the LazyList of examples property into the the GetCategories method of the service class.</p>\n<p>It seems that as long as the LazyList is created after the categories .ToList() call it properly works. So I ended up with this code:</p>\n<pre class=\"code\">categories.ForEach(category =>d\n            {\n                category.Examples =\n                    <span style=\"color: rgb(0,0,255)\">new</span> <span style=\"color: rgb(43,145,175)\">LazyList</span>                        &lt;DevExamples.Data.<span style=\"color: rgb(43,145,175)\">Example</span>&gt;(\n                        <span style=\"color: rgb(0,0,255)\">from</span> e <span style=\"color: rgb(0,0,255)\">in</span> repository.GetExamples()\n                        <span style=\"color: rgb(0,0,255)\">where</span> e.CategoryId == category.ID\n                        <span style=\"color: rgb(0,0,255)\">select</span> e);\n\n                <span style=\"color: rgb(0,0,255)\">var</span> subCategories = (<span style=\"color: rgb(0,0,255)\">from</span> sub <span style=\"color: rgb(0,0,255)\">in</span> categories\n                                     <span style=\"color: rgb(0,0,255)\">where</span> sub.ParentId == category.ID\n                                     <span style=\"color: rgb(0,0,255)\">select</span> sub).ToList();\n                category.SubCategories = subCategories;\n\n                subCategories.ForEach(c =&gt; c.Parent = category);\n\n            });\n</pre>\n<p><a href=\"http://11011.net/software/vspaste\"></a> </p>\n<div class=\"wlWriterSmartContent\" id=\"scid:0767317B-992E-4b12-91E0-4F059A8CECA8:b2911609-4a75-4f29-a40f-6f2131b013b6\" style=\"padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px\">\n  Technorati Tags: <a href=\"http://technorati.com/tags/aspnetmvc\" rel=\"tag\">aspnetmvc</a>\n</div>\n<img src=\"http://seanlynch.io/aggbug/57.aspx\" width=\"1\" height=\"1\">\n<p><span class=\"tve-leads-two-step-trigger tl-2step-trigger-0\"></span><span class=\"tve-leads-two-step-trigger tl-2step-trigger-0\"></span></p>","frontmatter":{"title":"Lazy list","date":"May 21, 2008"}}},"pageContext":{"slug":"/lazy-list/","previous":{"fields":{"slug":"/custom-rss-admin-feeds/"},"frontmatter":{"title":"Custom Rss Admin feeds"}},"next":{"fields":{"slug":"/scriptcontrol-question/"},"frontmatter":{"title":"ScriptControl question"}}}}